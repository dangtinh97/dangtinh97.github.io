<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"
          integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <title>Chuyển Đổi Đơn Vị Thời Gian</title>
    <style>
        body {
            background-color: #f5f6fa;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        .container {
            max-width: 900px;
            background: white;
            border-radius: 10px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            padding: 2rem;
            margin-top: 3rem;
        }
        h1 {
            color: #2c3e50;
            text-align: center;
            margin-bottom: 2rem;
            font-weight: 600;
        }
        .form-label {
            font-weight: 500;
            color: #34495e;
        }
        .form-control {
            border-radius: 5px;
            border: 1px solid #dcdcdc;
            transition: border-color 0.3s;
        }
        .form-control:focus {
            border-color: #3498db;
            box-shadow: 0 0 5px rgba(52, 152, 219, 0.3);
        }
        textarea.form-control {
            resize: vertical;
            min-height: 100px;
        }
        .btn {
            padding: 0.5rem 1.5rem;
            font-weight: 500;
            transition: transform 0.2s, background-color 0.2s;
        }
        .btn:hover {
            transform: translateY(-2px);
        }
        .btn-dark {
            background-color: #2c3e50;
            border-color: #2c3e50;
        }
        .btn-info {
            background-color: #3498db;
            border-color: #3498db;
        }
        .button-group {
            display: flex;
            gap: 1rem;
            justify-content: center;
            margin: 1.5rem 0;
        }
        .input-group {
            display: flex;
            gap: 1rem;
            flex-wrap: wrap;
        }
        .input-group .form-group {
            flex: 1;
            min-width: 200px;
        }
        .checkbox-group {
            display: flex;
            flex-wrap: wrap;
            gap: 1rem;
            justify-content: center;
            margin: 1rem 0;
        }
    </style>
</head>
<body>
<div class="container">
    <h1>Chuyển Đổi Đơn Vị Thời Gian</h1>
    <div class="row">
        <div class="col-12 mb-3">
            <label for="value" class="form-label">Giá trị cần chuyển đổi</label>
            <textarea id="value" class="form-control" placeholder="Nhập giá trị (số)"></textarea>
        </div>

        <div class="input-group mb-3">
            <div class="form-group">
                <label for="fromUnit" class="form-label">Đơn vị gốc</label>
                <select id="fromUnit" class="form-control">
                    <option value="seconds">Giây</option>
                    <option value="minutes">Phút</option>
                    <option value="hours">Giờ</option>
                    <option value="days">Ngày</option>
                    <option value="weeks">Tuần</option>
                    <option value="months">Tháng</option>
                    <option value="years">Năm</option>
                </select>
            </div>
            <div class="form-group">
                <label class="form-label">Đơn vị hiển thị</label>
                <div class="checkbox-group">
                    <label><input type="checkbox" id="showYearUnit" checked> Năm</label>
                    <label><input type="checkbox" id="showMonthUnit" checked> Tháng</label>
                    <label><input type="checkbox" id="showDayUnit" checked> Ngày</label>
                    <label><input type="checkbox" id="showHourUnit" checked> Giờ</label>
                    <label><input type="checkbox" id="showMinuteUnit" checked> Phút</label>
                    <label><input type="checkbox" id="showSecondUnit" checked> Giây</label>
                </div>
            </div>
        </div>

        <div class="button-group">
            <button onclick="convertTime()" class="btn btn-dark">Chuyển Đổi</button>
        </div>

        <div class="col-12">
            <label for="result" class="form-label">Kết quả</label>
            <textarea rows="5" readonly id="result" class="form-control" placeholder="Kết quả sẽ hiển thị ở đây"></textarea>
        </div>
    </div>

    <div class="row mt-4">
        <div class="col-12 mb-3">
            <label for="timestamp" class="form-label">Timestamp</label>
            <textarea id="timestamp" class="form-control" placeholder="Nhập timestamp (mặc định: giờ hiện tại)"></textarea>
        </div>

        <div class="input-group mb-3">
            <div class="form-group">
                <label for="timestampType" class="form-label">Đơn vị Timestamp</label>
                <select id="timestampType" class="form-control">
                    <option value="seconds">Giây</option>
                    <option value="milliseconds" selected>Mili-giây</option>
                </select>
            </div>
            <div class="form-group">
                <label for="timezone" class="form-label">Múi giờ</label>
                <select id="timezone" class="form-control">
                    <option value="client">Múi giờ máy (mặc định)</option>
                    <option value="UTC">UTC</option>
                    <option value="Asia/Ho_Chi_Minh">Asia/Ho_Chi_Minh (GMT+7)</option>
                    <option value="America/New_York">America/New_York (GMT-4/-5)</option>
                    <option value="Europe/London">Europe/London (GMT+0/+1)</option>
                    <option value="Asia/Tokyo">Asia/Tokyo (GMT+9)</option>
                    <option value="Australia/Sydney">Australia/Sydney (GMT+10/+11)</option>
                </select>
            </div>
        </div>

        <div class="input-group mb-3">
            <div class="form-group">
                <label class="form-label">Thành phần thời gian</label>
                <div class="checkbox-group">
                    <label><input type="checkbox" id="showYear" checked> Năm</label>
                    <label><input type="checkbox" id="showMonth" checked> Tháng</label>
                    <label><input type="checkbox" id="showDay" checked> Ngày</label>
                    <label><input type="checkbox" id="showHour" checked> Giờ</label>
                    <label><input type="checkbox" id="showMinute" checked> Phút</label>
                    <label><input type="checkbox" id="showSecond" checked> Giây</label>
                </div>
            </div>
        </div>

        <div class="button-group">
            <button onclick="convertTimestamp()" class="btn btn-dark">Chuyển Đổi</button>
        </div>

        <div class="col-12">
            <label for="timestampResult" class="form-label">Kết quả</label>
            <textarea rows="5" readonly id="timestampResult" class="form-control" placeholder="Kết quả sẽ hiển thị ở đây"></textarea>
        </div>
    </div>

    <div class="row mt-4">
        <div class="col-12 mb-3">
            <label for="distanceTimestamp" class="form-label">Timestamp</label>
            <textarea id="distanceTimestamp" class="form-control" placeholder="Nhập timestamp"></textarea>
        </div>

        <div class="input-group mb-3">
            <div class="form-group">
                <label for="distanceTimestampType" class="form-label">Đơn vị Timestamp</label>
                <select id="distanceTimestampType" class="form-control">
                    <option value="seconds">Giây</option>
                    <option value="milliseconds" selected>Mili-giây</option>
                </select>
            </div>
            <div class="form-group">
                <label for="distanceDirection" class="form-label">Hướng tính</label>
                <select id="distanceDirection" class="form-control">
                    <option value="toNow">Từ timestamp đến hiện tại</option>
                    <option value="fromNow">Từ hiện tại đến timestamp</option>
                </select>
            </div>
        </div>

        <div class="input-group mb-3">
            <div class="form-group">
                <label class="form-label">Đơn vị hiển thị</label>
                <div class="checkbox-group">
                    <label><input type="checkbox" id="showYearDistance" checked> Năm</label>
                    <label><input type="checkbox" id="showMonthDistance" checked> Tháng</label>
                    <label><input type="checkbox" id="showDayDistance" checked> Ngày</label>
                    <label><input type="checkbox" id="showHourDistance" checked> Giờ</label>
                    <label><input type="checkbox" id="showMinuteDistance" checked> Phút</label>
                    <label><input type="checkbox" id="showSecondDistance" checked> Giây</label>
                </div>
            </div>
        </div>

        <div class="button-group">
            <button onclick="calculateDistance()" class="btn btn-dark">Tính Khoảng Cách</button>
        </div>

        <div class="col-12">
            <label for="distanceResult" class="form-label">Kết quả</label>
            <textarea rows="5" readonly id="distanceResult" class="form-control" placeholder="Kết quả sẽ hiển thị ở đây"></textarea>
        </div>
    </div>
</div>

<script>
  const clientTimezone = Intl.DateTimeFormat().resolvedOptions().timeZone;
  document.getElementById('timezone').options[0].text = `Múi giờ máy (${clientTimezone})`;
  const timestampInput = document.getElementById('timestamp');
  timestampInput.value = Date.now();
  convertTimestamp();

  function convertTime() {
    const value = parseFloat(document.getElementById('value').value.trim());
    const fromUnit = document.getElementById('fromUnit').value;
    const showYear = document.getElementById('showYearUnit').checked;
    const showMonth = document.getElementById('showMonthUnit').checked;
    const showDay = document.getElementById('showDayUnit').checked;
    const showHour = document.getElementById('showHourUnit').checked;
    const showMinute = document.getElementById('showMinuteUnit').checked;
    const showSecond = document.getElementById('showSecondUnit').checked;

    if (isNaN(value) || value < 0) {
      document.getElementById('result').value = 'Vui lòng nhập một giá trị số hợp lệ!';
      return;
    }

    if (!showYear && !showMonth && !showDay && !showHour && !showMinute && !showSecond) {
      document.getElementById('result').value = 'Vui lòng chọn ít nhất một đơn vị hiển thị!';
      return;
    }

    const conversionsToSeconds = {
      seconds: 1,
      minutes: 60,
      hours: 3600,
      days: 86400,
      weeks: 604800,
      months: 2628000,
      years: 31536000
    };

    const totalSeconds = value * conversionsToSeconds[fromUnit];
    let seconds = Math.floor(totalSeconds);
    let minutes = Math.floor(seconds / 60);
    seconds %= 60;
    let hours = Math.floor(minutes / 60);
    minutes %= 60;
    let days = Math.floor(hours / 24);
    hours %= 24;
    let months = Math.floor(days / 30.44);
    days = Math.floor(days % 30.44);
    let years = Math.floor(months / 12);
    months %= 12;

    let resultParts = [];
    if (showYear && years > 0) resultParts.push(`${years} năm`);
    if (showMonth && months > 0) resultParts.push(`${months} tháng`);
    if (showDay && days > 0) resultParts.push(`${days} ngày`);
    if (showHour && hours > 0) resultParts.push(`${hours} giờ`);
    if (showMinute && minutes > 0) resultParts.push(`${minutes} phút`);
    if (showSecond && seconds > 0) resultParts.push(`${seconds} giây`);

    const unitsVi = {
      seconds: 'giây',
      minutes: 'phút',
      hours: 'giờ',
      days: 'ngày',
      weeks: 'tuần',
      months: 'tháng',
      years: 'năm'
    };

    const resultStr = resultParts.length > 0 ? resultParts.join(', ') : '0 giây';
    document.getElementById('result').value = `${value} ${unitsVi[fromUnit]} = ${resultStr}`;
  }

  function convertTimestamp() {
    let timestamp = parseFloat(document.getElementById('timestamp').value.trim());
    const timestampType = document.getElementById('timestampType').value;
    const timezone = document.getElementById('timezone').value;
    const showYear = document.getElementById('showYear').checked;
    const showMonth = document.getElementById('showMonth').checked;
    const showDay = document.getElementById('showDay').checked;
    const showHour = document.getElementById('showHour').checked;
    const showMinute = document.getElementById('showMinute').checked;
    const showSecond = document.getElementById('showSecond').checked;

    if (isNaN(timestamp)) {
      timestamp = Date.now();
      document.getElementById('timestamp').value = timestamp;
    }

    if (!showYear && !showMonth && !showDay && !showHour && !showMinute && !showSecond) {
      document.getElementById('timestampResult').value = 'Vui lòng chọn ít nhất một thành phần thời gian!';
      return;
    }

    const milliseconds = timestampType === 'seconds' ? timestamp * 1000 : timestamp;
    const date = new Date(milliseconds);
    const options = {
      timeZone: timezone === 'client' ? clientTimezone : timezone,
      year: showYear ? 'numeric' : undefined,
      month: showMonth ? '2-digit' : undefined,
      day: showDay ? '2-digit' : undefined,
      hour: showHour ? '2-digit' : undefined,
      minute: showMinute ? '2-digit' : undefined,
      second: showSecond ? '2-digit' : undefined,
      hour12: false
    };

    const formatter = new Intl.DateTimeFormat('vi', options);
    const formattedDate = formatter.format(date);
    const tzName = timezone === 'client' ? clientTimezone : timezone;

    document.getElementById('timestampResult').value = `${timestamp} ${timestampType === 'seconds' ? 'giây' : 'mili-giây'} = ${formattedDate} (${tzName})`;
  }

  function calculateDistance() {
    const timestamp = parseFloat(document.getElementById('distanceTimestamp').value.trim());
    const timestampType = document.getElementById('distanceTimestampType').value;
    const direction = document.getElementById('distanceDirection').value;
    const showYear = document.getElementById('showYearDistance').checked;
    const showMonth = document.getElementById('showMonthDistance').checked;
    const showDay = document.getElementById('showDayDistance').checked;
    const showHour = document.getElementById('showHourDistance').checked;
    const showMinute = document.getElementById('showMinuteDistance').checked;
    const showSecond = document.getElementById('showSecondDistance').checked;

    if (isNaN(timestamp)) {
      document.getElementById('distanceResult').value = 'Vui lòng nhập một timestamp hợp lệ!';
      return;
    }

    if (!showYear && !showMonth && !showDay && !showHour && !showMinute && !showSecond) {
      document.getElementById('distanceResult').value = 'Vui lòng chọn ít nhất một đơn vị hiển thị!';
      return;
    }

    const milliseconds = timestampType === 'seconds' ? timestamp * 1000 : timestamp;
    const now = Date.now();
    const isFuture = milliseconds > now;
    const effectiveDirection = direction === 'fromNow' ? (isFuture ? 'fromNow' : 'toNow') : (isFuture ? 'fromNow' : 'toNow');
    let diffMs = isFuture ? milliseconds - now : now - milliseconds;

    const secondsTotal = Math.floor(diffMs / 1000);
    let seconds = secondsTotal % 60;
    let minutes = Math.floor(secondsTotal / 60);
    let hours = Math.floor(minutes / 60);
    minutes %= 60;
    let days = Math.floor(hours / 24);
    hours %= 24;
    let months = Math.floor(days / 30.44);
    days = Math.floor(days % 30.44);
    let years = Math.floor(months / 12);
    months %= 12;

    let resultParts = [];
    if (showYear && years > 0) resultParts.push(`${years} năm`);
    if (showMonth && months > 0) resultParts.push(`${months} tháng`);
    if (showDay && days > 0) resultParts.push(`${days} ngày`);
    if (showHour && hours > 0) resultParts.push(`${hours} giờ`);
    if (showMinute && minutes > 0) resultParts.push(`${minutes} phút`);
    if (showSecond && seconds > 0) resultParts.push(`${seconds} giây`);

    const resultStr = resultParts.length > 0 ? resultParts.join(', ') : '0 giây';
    const directionText = effectiveDirection === 'toNow' ? 'đến hiện tại' : 'từ hiện tại';
    document.getElementById('distanceResult').value = `Khoảng cách ${directionText}: ${resultStr}`;
  }
</script>
</body>
</html>
